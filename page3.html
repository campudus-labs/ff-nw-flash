<!DOCTYPE html>
<html>
<head>
  <title>Hello World!</title>
  <script>
    var path = require('path');
    var flashTrust = require('nw-flash-trust');
    var appName = 'ff-nw-flash';

    try {
      // Initialization and parsing config file for given appName (if already exists).
      var trustManager = flashTrust.initSync(appName);

      trustManager.empty();
      trustManager.add(process.cwd());

      var isTrusted = trustManager.isTrusted(path.resolve(process.cwd(), 'flash-test.swf'));
    } catch (err) {
      if (err.message === 'Flash Player config folder not found.') {
        // Directory needed to do the work doesn't exist.
        // Probably Flash Player is not installed, there is nothing I can do.
      }
    }
  </script>
</head>
<body>
<h1>Flash test</h1>

<div id="flash">
  <div id="flashContent">
    <object type="application/x-shockwave-flash" data="flash-test.swf" width="200" height="100" id="flash-test">
      <param name="movie" value="flash-test.swf"/>
      <param name="quality" value="high"/>
      <param name="bgcolor" value="#ffffff"/>
      <param name="play" value="true"/>
      <param name="loop" value="true"/>
      <param name="wmode" value="window"/>
      <param name="scale" value="showall"/>
      <param name="menu" value="true"/>
      <param name="devicefont" value="false"/>
      <param name="salign" value=""/>
      <param name="allowScriptAccess" value="sameDomain"/>
      <a href="http://www.adobe.com/go/getflash">
        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"
             alt="Get Adobe Flash player"/>
      </a>
    </object>
  </div>
</div>

<ul>
  <li><a href="index.html">Back to index</a></li>
</ul>

<script>
  var counter = 0;
  var flashObj = document.getElementById('flash-test');

  function talkToFlash() {
    counter++;
    flashObj.callFlashFunction('counter=' + counter);
    setTimeout(talkToFlash, 500);
  }

  function onFlashLoaded() {
    console.log('flash loaded!');
    talkToFlash();
  }
</script>
</body>
</html>
